<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asuntojen hintakartta 2025</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        
        #header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px;
        }
        
        #stats {
            display: flex;
            gap: 15px;
            padding: 15px 20px;
            background: #f8f9fa;
            flex-wrap: wrap;
        }
        .stat-box {
            background: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stat-box .label { font-size: 12px; color: #666; }
        .stat-box .value { font-size: 20px; font-weight: bold; }
        
        #map { height: calc(100vh - 120px); width: 100%; }
        
        .legend {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .legend-item { display: flex; align-items: center; gap: 8px; margin: 5px 0; }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 1px solid #999;
        }
        
        .popup-content { min-width: 250px; }
        .popup-content h3 { color: #1e3c72; margin-bottom: 8px; }
        .popup-content .price { font-size: 28px; font-weight: bold; color: #27ae60; }
        .popup-content .details { margin-top: 8px; color: #666; font-size: 13px; }
        
        #search-box {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        #search-box input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 200px;
        }
        
        .city-buttons {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1000;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        .city-buttons button {
            padding: 8px 15px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .city-buttons button:hover { background: #f0f0f0; }
        
        .info-box {
            position: absolute;
            bottom: 30px;
            left: 10px;
            z-index: 1000;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>üè† Asuntojen keskihintakartta 2025</h1>
        <p>Vanhojen osakeasuntojen neli√∂hinnat (EUR/m¬≤) | Tilastokeskus</p>
    </div>
    
    <div id="stats">
        <div class="stat-box">
            <div class="label">Alueita kartalla</div>
            <div class="value">100</div>
        </div>
        <div class="stat-box">
            <div class="label">Keskihinta</div>
            <div class="value">4,209 ‚Ç¨/m¬≤</div>
        </div>
        <div class="stat-box">
            <div class="label">Kallein</div>
            <div class="value" style="color: #e74c3c;">8,611 ‚Ç¨/m¬≤</div>
        </div>
        <div class="stat-box">
            <div class="label">Halvin</div>
            <div class="value" style="color: #27ae60;">1,724 ‚Ç¨/m¬≤</div>
        </div>
    </div>
    
    <div class="city-buttons">
        <button onclick="map.setView([60.1699, 24.9384], 12)">Helsinki</button>
        <button onclick="map.setView([60.2052, 24.6566], 12)">Espoo</button>
        <button onclick="map.setView([60.2944, 24.9722], 12)">Vantaa</button>
        <button onclick="map.setView([61.4978, 23.7608], 12)">Tampere</button>
        <button onclick="map.setView([60.4518, 22.6306], 12)">Turku</button>
    </div>
    
    <div id="search-box">
        <input type="text" id="search" placeholder="Hae postinumeroa..." onkeyup="filterMap()">
    </div>
    
    <div id="map"></div>
    
    <div class="info-box">
        üõà 100 postinumeroaluetta oikeilla aluerajoilla
    </div>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        var map = L.map('map').setView([60.1699, 24.9384], 11);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap'
        }).addTo(map);
        
        var priceData = {"00100": {"name": "00100  Helsinki keskusta - Etu-T\u00f6\u00f6l\u00f6 (Helsinki)", "price": 7344.333333333333}, "00120": {"name": "00120  Punavuori - Bulevardi (Helsinki)", "price": 8345.0}, "00130": {"name": "00130  Kaartinkaupunki (Helsinki)", "price": 7617.333333333333}, "00140": {"name": "00140  Kaivopuisto - Ullanlinna (Helsinki)", "price": 8611.0}, "00150": {"name": "00150  Punavuori - Eira - Hernesaari (Helsinki)", "price": 8211.0}, "00160": {"name": "00160  Katajanokka (Helsinki)", "price": 7387.666666666667}, "00170": {"name": "00170  Kruununhaka (Helsinki)", "price": 7328.666666666667}, "00180": {"name": "00180  Kamppi - Ruoholahti (Helsinki)", "price": 6815.666666666667}, "00200": {"name": "00200  Pohjois-Lauttasaari (Helsinki)", "price": 6648.0}, "00210": {"name": "00210  Vattuniemi (Helsinki)", "price": 6184.666666666667}, "00220": {"name": "00220  J\u00e4tk\u00e4saari (Helsinki)", "price": 7235.666666666667}, "00240": {"name": "00240  L\u00e4nsi-Pasila (Helsinki)", "price": 4594.0}, "00250": {"name": "00250  Taka-T\u00f6\u00f6l\u00f6 (Helsinki)", "price": 6362.333333333333}, "00260": {"name": "00260  Keski-T\u00f6\u00f6l\u00f6 (Helsinki)", "price": 7074.333333333333}, "00270": {"name": "00270  Pohjois-Meilahti (Helsinki)", "price": 5726.333333333333}, "00280": {"name": "00280  Ruskeasuo (Helsinki)", "price": 5266.0}, "00300": {"name": "00300  Pikku Huopalahti (Helsinki)", "price": 4602.0}, "00310": {"name": "00310  Kivihaka (Helsinki)", "price": 3918.0}, "00320": {"name": "00320  Etel\u00e4-Haaga (Helsinki)", "price": 4971.666666666667}, "00330": {"name": "00330  Munkkiniemi (Helsinki)", "price": 6412.333333333333}, "00340": {"name": "00340  Kuusisaari - Lehtisaari (Helsinki)", "price": 3520.0}, "00350": {"name": "00350  Munkkivuori - Niemenm\u00e4ki (Helsinki)", "price": 4659.666666666667}, "00360": {"name": "00360  Pajam\u00e4ki (Helsinki)", "price": 3937.6666666666665}, "00370": {"name": "00370  Reimarla (Helsinki)", "price": 3334.6666666666665}, "00380": {"name": "00380  Pit\u00e4j\u00e4nm\u00e4en yritysalue (Helsinki)", "price": 4625.5}, "00390": {"name": "00390  Konala (Helsinki)", "price": 3241.5}, "00400": {"name": "00400  Pohjois-Haaga (Helsinki)", "price": 4227.666666666667}, "00410": {"name": "00410  Malminkartano (Helsinki)", "price": 2592.75}, "00420": {"name": "00420  Kannelm\u00e4ki (Helsinki)", "price": 3034.25}, "00430": {"name": "00430  Maununneva - Kuninkaantammi (Helsinki)", "price": 3760.3333333333335}, "00440": {"name": "00440  Lassila (Helsinki)", "price": 3479.6666666666665}, "00500": {"name": "00500  S\u00f6rn\u00e4inen - Harju (Helsinki)", "price": 5160.333333333333}, "00510": {"name": "00510  Alppila - Vallila (Helsinki)", "price": 5451.333333333333}, "00520": {"name": "00520  It\u00e4- ja Keski-Pasila (Helsinki)", "price": 5742.0}, "00530": {"name": "00530  Kallio (Helsinki)", "price": 5685.0}, "00540": {"name": "00540  Kalasatama - Sompasaari (Helsinki)", "price": 8125.0}, "00550": {"name": "00550  Vallila - Hermanni (Helsinki)", "price": 5310.666666666667}, "00560": {"name": "00560  Toukola - Kumpula - Vanhakaupunki (Helsinki)", "price": 5445.666666666667}, "00570": {"name": "00570  Kulosaari (Helsinki)", "price": 5620.0}, "00580": {"name": "00580  Kalasatama - Kyl\u00e4saari (Helsinki)", "price": 7534.0}, "00590": {"name": "00590  Kruunuvuorenranta (Helsinki)", "price": 5199.0}, "00600": {"name": "00600  Koskela (Helsinki)", "price": 3509.6666666666665}, "00610": {"name": "00610  K\u00e4pyl\u00e4 (Helsinki)", "price": 5543.25}, "00620": {"name": "00620  Mets\u00e4l\u00e4 - Etel\u00e4-Oulunkyl\u00e4 (Helsinki)", "price": 3807.3333333333335}, "00630": {"name": "00630  Maunula (Helsinki)", "price": 3668.75}, "00640": {"name": "00640  Oulunkyl\u00e4 - Patola (Helsinki)", "price": 3904.25}, "00650": {"name": "00650  Ver\u00e4j\u00e4m\u00e4ki (Helsinki)", "price": 4637.0}, "00660": {"name": "00660  L\u00e4nsi-Pakila (Helsinki)", "price": 4164.0}, "00670": {"name": "00670  Palohein\u00e4 (Helsinki)", "price": 3773.0}, "00680": {"name": "00680  It\u00e4-Pakila (Helsinki)", "price": 3564.0}, "00690": {"name": "00690  Torpparinm\u00e4ki (Helsinki)", "price": 3377.0}, "00700": {"name": "00700  Malmi (Helsinki)", "price": 3091.0}, "00710": {"name": "00710  Pihlajam\u00e4ki - Viikinm\u00e4ki (Helsinki)", "price": 2803.25}, "00720": {"name": "00720  Pukinm\u00e4ki (Helsinki)", "price": 2825.25}, "00730": {"name": "00730  Tapanila (Helsinki)", "price": 3708.25}, "00740": {"name": "00740  Siltam\u00e4ki (Helsinki)", "price": 2265.25}, "00750": {"name": "00750  Tapulikaupunki (Helsinki)", "price": 2423.3333333333335}, "00760": {"name": "00760  Puistola - Heikinlaakso (Helsinki)", "price": 3006.0}, "00770": {"name": "00770  Jakom\u00e4ki - Alppikyl\u00e4 (Helsinki)", "price": 2612.5}, "00780": {"name": "00780  Tapaninvainio (Helsinki)", "price": 2896.0}, "00790": {"name": "00790  Viikki (Helsinki)", "price": 4187.0}, "00800": {"name": "00800  L\u00e4nsi-Herttoniemi (Helsinki)", "price": 4685.666666666667}, "00810": {"name": "00810  Herttoniemenranta (Helsinki)", "price": 5218.333333333333}, "00820": {"name": "00820  Roihuvuori (Helsinki)", "price": 3880.3333333333335}, "00830": {"name": "00830  Tammisalo (Helsinki)", "price": 4396.0}, "00840": {"name": "00840  Yliskyl\u00e4 (Helsinki)", "price": 3707.0}, "00850": {"name": "00850  Jollas (Helsinki)", "price": 4191.0}, "00870": {"name": "00870  Gunillanm\u00e4ki - Hevossalmi (Helsinki)", "price": 3166.3333333333335}, "00900": {"name": "00900  Puotinharju (Helsinki)", "price": 2254.0}, "00910": {"name": "00910  Puotila (Helsinki)", "price": 3235.6666666666665}, "00920": {"name": "00920  Myllypuro (Helsinki)", "price": 2849.75}, "00930": {"name": "00930  It\u00e4keskus - Marjaniemi (Helsinki)", "price": 2596.0}, "00940": {"name": "00940  Kontula - Vesala - Kivikko (Helsinki)", "price": 2435.0}, "00950": {"name": "00950  Vartioharju (Helsinki)", "price": 3059.3333333333335}, "00960": {"name": "00960  Pohjois-Vuosaari (Helsinki)", "price": 2540.5}, "00970": {"name": "00970  Mellunm\u00e4ki (Helsinki)", "price": 2315.75}, "00980": {"name": "00980  Etel\u00e4-Vuosaari (Helsinki)", "price": 3000.0}, "00990": {"name": "00990  Aurinkolahti (Helsinki)", "price": 4438.5}, "01150": {"name": "01150  S\u00f6derkulla (Sipoo)", "price": 2745.3333333333335}, "01200": {"name": "01200  Hakunila (Vantaa)", "price": 2075.0}, "01230": {"name": "01230  Vaarala (Vantaa)", "price": 2825.0}, "01260": {"name": "01260  It\u00e4-Hakkila (Vantaa)", "price": 3073.0}, "01280": {"name": "01280  L\u00e4nsim\u00e4ki (Vantaa)", "price": 1996.5}, "01300": {"name": "01300  Tikkurila (Vantaa)", "price": 3537.75}, "01340": {"name": "01340  Leinel\u00e4 (Vantaa)", "price": 3673.5}, "01350": {"name": "01350  Hiekkaharju (Vantaa)", "price": 2746.25}, "01360": {"name": "01360  Koivukyl\u00e4-Havukoski (Vantaa)", "price": 1724.0}, "01370": {"name": "01370  Jokiniemi (Vantaa)", "price": 3143.6666666666665}, "01380": {"name": "01380  Kuusikko-Hakkila (Vantaa)", "price": 3610.0}, "01390": {"name": "01390  Ruskeasanta-Ilola (Vantaa)", "price": 2781.0}, "01400": {"name": "01400  Rekola (Vantaa)", "price": 3258.25}, "01450": {"name": "01450  Korso (Vantaa)", "price": 2143.25}, "01480": {"name": "01480  Mikkola (Vantaa)", "price": 1817.3333333333333}, "01490": {"name": "01490  Nikinm\u00e4ki (Vantaa)", "price": 3418.0}, "01510": {"name": "01510  Kirkonkyl\u00e4-Verom\u00e4ki (Vantaa)", "price": 4031.5}, "01520": {"name": "01520  Tammisto (Vantaa)", "price": 3844.3333333333335}, "01600": {"name": "01600  Myyrm\u00e4ki (Vantaa)", "price": 2491.3333333333335}, "01610": {"name": "01610  Kaivoksela (Vantaa)", "price": 2841.5}, "01620": {"name": "01620  Martinlaakso (Vantaa)", "price": 2491.5}, "01630": {"name": "01630  H\u00e4meenkyl\u00e4 (Vantaa)", "price": 2591.0}};
        var bboxes = {"00100": {"south": 60.1201266, "north": 60.2201266, "west": 24.8835655, "east": 24.9835655}, "00120": {"south": 60.1135798, "north": 60.2135798, "west": 24.8892822, "east": 24.9892822}, "00130": {"south": 60.1146481, "north": 60.2146481, "west": 24.8977906, "east": 24.9977906}, "00140": {"south": 60.1078088, "north": 60.2078088, "west": 24.9013147, "east": 25.0013147}, "00150": {"south": 60.1088846, "north": 60.2088846, "west": 24.8877319, "east": 24.9877319}, "00160": {"south": 60.1171438, "north": 60.2171438, "west": 24.9150197, "east": 25.0150197}, "00170": {"south": 60.1222232, "north": 60.2222232, "west": 24.9062119, "east": 25.0062119}, "00180": {"south": 60.1136804, "north": 60.2136804, "west": 24.8687668, "east": 24.9687668}, "00200": {"south": 60.1104249, "north": 60.2104249, "west": 24.8236589, "east": 24.9236589}, "00210": {"south": 60.1012919, "north": 60.2012919, "west": 24.833462, "east": 24.933462}, "00220": {"south": 60.1054856, "north": 60.2054856, "west": 24.8636745, "east": 24.9636745}, "00240": {"south": 60.1561023, "north": 60.2561023, "west": 24.8754515, "east": 24.9754515}, "00250": {"south": 60.1371187, "north": 60.2371187, "west": 24.8653615, "east": 24.9653615}, "00260": {"south": 60.1299372, "north": 60.2299372, "west": 24.8738624, "east": 24.9738624}, "00270": {"south": 60.1440871, "north": 60.2440871, "west": 24.8525576, "east": 24.9525576}, "00280": {"south": 60.1534852, "north": 60.2534852, "west": 24.8544518, "east": 24.9544518}, "00300": {"south": 60.1524669, "north": 60.2524669, "west": 24.8464699, "east": 24.9464699}, "00310": {"south": 60.2118211, "north": 60.3118211, "west": 24.5956147, "east": 24.6956147}, "00320": {"south": 60.1651423, "north": 60.2651423, "west": 24.8452174, "east": 24.9452174}, "00330": {"south": 60.1474439, "north": 60.2474439, "west": 24.8265612, "east": 24.9265612}, "00340": {"south": 60.1346962, "north": 60.2346962, "west": 24.8092721, "east": 24.9092721}, "00350": {"south": 60.1571506, "north": 60.2571506, "west": 24.8182262, "east": 24.9182262}, "00360": {"south": 60.1680349, "north": 60.2680349, "west": 24.8038821, "east": 24.9038821}, "00370": {"south": 60.1739706, "north": 60.2739706, "west": 24.8031357, "east": 24.9031357}, "00380": {"south": 60.1670181, "north": 60.2670181, "west": 24.8226205, "east": 24.9226205}, "00390": {"south": 60.1898169, "north": 60.2898169, "west": 24.7986241, "east": 24.8986241}, "00400": {"south": 60.176976, "north": 60.276976, "west": 24.8477608, "east": 24.9477608}, "00410": {"south": 60.1990559, "north": 60.2990559, "west": 24.8075736, "east": 24.9075736}, "00420": {"south": 60.1916978, "north": 60.2916978, "west": 24.8313191, "east": 24.9313191}, "00430": {"south": 60.2052677, "north": 60.3052677, "west": 24.8420456, "east": 24.9420456}, "00440": {"south": 60.1857643, "north": 60.2857643, "west": 24.8335969, "east": 24.9335969}, "00500": {"south": 60.1381424, "north": 60.2381424, "west": 24.9107631, "east": 25.0107631}, "00510": {"south": 60.141866, "north": 60.241866, "west": 24.899709, "east": 24.999709}, "00520": {"south": 60.1623285, "north": 60.2623285, "west": 24.9386958, "east": 25.0386958}, "00530": {"south": 60.1319696, "north": 60.2319696, "west": 24.9015089, "east": 25.0015089}, "00540": {"south": 60.1318239, "north": 60.2318239, "west": 24.9271559, "east": 25.0271559}, "00550": {"south": 60.1466071, "north": 60.2466071, "west": 24.909605, "east": 25.009605}, "00560": {"south": 60.1588875, "north": 60.2588875, "west": 24.922697, "east": 25.022697}, "00570": {"south": 60.1292174, "north": 60.2292173, "west": 24.9446044, "east": 25.0446044}, "00580": {"south": 60.1406058, "north": 60.2406058, "west": 24.9264808, "east": 25.0264808}, "00590": {"south": 60.1217026, "north": 60.2217026, "west": 24.9723946, "east": 25.0723946}, "00600": {"south": 60.1688418, "north": 60.2688418, "west": 24.9128605, "east": 25.0128605}, "00610": {"south": 60.1614302, "north": 60.2614302, "west": 24.897484, "east": 24.997484}, "00620": {"south": 60.1722508, "north": 60.2722508, "west": 24.8907331, "east": 24.9907331}, "00630": {"south": 60.1822919, "north": 60.2822919, "west": 24.8744168, "east": 24.9744168}, "00640": {"south": 60.1821293, "north": 60.2821293, "west": 24.9126804, "east": 25.0126804}, "00650": {"south": 60.1777356, "north": 60.2777356, "west": 24.9257537, "east": 25.0257537}, "00660": {"south": 60.1902983, "north": 60.2902983, "west": 24.8781628, "east": 24.9781628}, "00670": {"south": 60.2009371, "north": 60.3009371, "west": 24.8736684, "east": 24.9736684}, "00680": {"south": 60.193655, "north": 60.293655, "west": 24.9051432, "east": 25.0051432}, "00690": {"south": 60.2103823, "north": 60.3103823, "west": 24.9023517, "east": 25.0023517}, "00700": {"south": 60.1996278, "north": 60.2996278, "west": 24.9716766, "east": 25.0716766}, "00710": {"south": 60.1811625, "north": 60.2811625, "west": 24.9496819, "east": 25.0496819}, "00720": {"south": 60.1936296, "north": 60.2936296, "west": 24.9396012, "east": 25.0396012}, "00730": {"south": 60.2180057, "north": 60.3180057, "west": 24.9686145, "east": 25.0686145}, "00740": {"south": 60.2233369, "north": 60.3233369, "west": 24.9480445, "east": 25.0480445}, "00750": {"south": 60.2300271, "north": 60.3300271, "west": 24.9806104, "east": 25.0806104}, "00760": {"south": 60.2222907, "north": 60.3222907, "west": 25.005776, "east": 25.105776}, "00770": {"south": 60.2082578, "north": 60.3082578, "west": 25.0165734, "east": 25.1165734}, "00780": {"south": 60.2082, "north": 60.3082, "west": 24.9406434, "east": 25.0406434}, "00790": {"south": 60.1786297, "north": 60.2786297, "west": 24.9742336, "east": 25.0742336}, "00800": {"south": 60.1550568, "north": 60.2550568, "west": 24.9894611, "east": 25.0894611}, "00810": {"south": 60.152769, "north": 60.252769, "west": 24.9821405, "east": 25.0821405}, "00820": {"south": 60.1500548, "north": 60.2500548, "west": 25.0071459, "east": 25.1071459}, "00830": {"south": 60.1422609, "north": 60.2422609, "west": 25.0144949, "east": 25.1144949}, "00840": {"south": 60.126643, "north": 60.226643, "west": 25.0011365, "east": 25.1011365}, "00850": {"south": 60.1130611, "north": 60.2130611, "west": 25.0246287, "east": 25.1246287}, "00870": {"south": 60.1157127, "north": 60.2157127, "west": 24.9945886, "east": 25.0945886}, "00900": {"south": 60.1645778, "north": 60.2645778, "west": 25.0327809, "east": 25.1327809}, "00910": {"south": 60.1622052, "north": 60.2622052, "west": 25.0485081, "east": 25.1485081}, "00920": {"south": 60.1718494, "north": 60.2718494, "west": 25.0178302, "east": 25.1178302}, "00930": {"south": 60.1579816, "north": 60.2579816, "west": 25.033728, "east": 25.133728}, "00940": {"south": 60.1874005, "north": 60.2874005, "west": 25.0259956, "east": 25.1259956}, "00950": {"south": 60.1721844, "north": 60.2721844, "west": 25.057586, "east": 25.157586}, "00960": {"south": 60.1729682, "north": 60.2729682, "west": 25.0874865, "east": 25.1874865}, "00970": {"south": 60.1828473, "north": 60.2828473, "west": 25.0731026, "east": 25.1731026}, "00980": {"south": 60.1555615, "north": 60.2555615, "west": 25.0835931, "east": 25.1835931}, "00990": {"south": 60.1545568, "north": 60.2545568, "west": 25.1029592, "east": 25.2029592}, "01150": {"south": 60.2429148, "north": 60.3429148, "west": 25.2951221, "east": 25.3951221}, "01200": {"south": 60.2303673, "north": 60.3303673, "west": 25.0694685, "east": 25.1694685}, "01230": {"south": 60.2164323, "north": 60.3164323, "west": 25.0450485, "east": 25.1450485}, "01260": {"south": 60.2466014, "north": 60.3466014, "west": 25.0677723, "east": 25.1677723}, "01280": {"south": 60.1982871, "north": 60.2982871, "west": 25.053402, "east": 25.153402}, "01300": {"south": 60.2444806, "north": 60.3444806, "west": 24.9741794, "east": 25.0741794}, "01340": {"south": 60.2745884, "north": 60.3745884, "west": 24.9900612, "east": 25.0900612}, "01350": {"south": 60.2585174, "north": 60.3585174, "west": 24.9860534, "east": 25.0860534}, "01360": {"south": 60.2698802, "north": 60.3698802, "west": 25.0133847, "east": 25.1133847}, "01370": {"south": 60.2474041, "north": 60.3474041, "west": 25.0107872, "east": 25.1107872}, "01380": {"south": 60.2339752, "north": 60.3339752, "west": 25.0242106, "east": 25.1242106}, "01390": {"south": 60.2766064, "north": 60.3766064, "west": 24.9645213, "east": 25.0645213}, "01400": {"south": 60.2806732, "north": 60.3806732, "west": 25.024324, "east": 25.124324}, "01450": {"south": 60.3042921, "north": 60.4042921, "west": 25.0185042, "east": 25.1185042}, "01480": {"south": 60.2966346, "north": 60.3966346, "west": 25.057867, "east": 25.157867}, "01490": {"south": 60.2946652, "north": 60.3946652, "west": 25.0865166, "east": 25.1865166}, "01510": {"south": 60.2410115, "north": 60.3410115, "west": 24.9211823, "east": 25.0211823}, "01520": {"south": 60.2297902, "north": 60.3297902, "west": 24.912358, "east": 25.012358}, "01600": {"south": 60.2141208, "north": 60.3141208, "west": 24.8019597, "east": 24.9019597}, "01610": {"south": 60.2131524, "north": 60.3131524, "west": 24.8240902, "east": 24.9240902}, "01620": {"south": 60.2286988, "north": 60.3286988, "west": 24.8027457, "east": 24.9027457}, "01630": {"south": 60.2173109, "north": 60.3173109, "west": 24.7441286, "east": 24.8441286}};
        
        function getColor(price) {
            if (price > 8000) return '#8B0000';
            else if (price > 6000) return '#e74c3c';
            else if (price > 5000) return '#f39c12';
            else if (price > 4000) return '#f1c40f';
            else if (price > 3000) return '#9acd32';
            else if (price > 2000) return '#27ae60';
            else return '#2ecc71';
        }
        
        var layers = [];
        
        // Draw each postal code as a rectangle using bounding box
        for (var postcode in priceData) {
            var data = priceData[postcode];
            var price = data.price;
            var bbox = bboxes[postcode];
            
            if (bbox) {
                var bounds = [
                    [bbox.south, bbox.west],
                    [bbox.north, bbox.east]
                ];
                
                var rect = L.rectangle(bounds, {
                    color: '#fff',
                    weight: 1,
                    fillColor: getColor(price),
                    fillOpacity: 0.7
                }).addTo(map);
                
                rect.bindPopup(
                    '<div class="popup-content">' +
                    '<h3>' + postcode + '</h3>' +
                    '<div class="price">' + price.toLocaleString() + ' ‚Ç¨/m¬≤</div>' +
                    '<div class="details">' + data.name + '</div>' +
                    '</div>'
                );
                
                rect.postcode = postcode;
                layers.push(rect);
            }
        }
        
        var legend = L.control({position: 'bottomright'});
        legend.onAdd = function(map) {
            var div = L.DomUtil.create('div', 'legend');
            div.innerHTML = '<b>Hinta ‚Ç¨/m¬≤</b><br>';
            var grades = [0, 1500, 2000, 3000, 4000, 5000, 6000, 8000];
            var labels = ['< 1500', '1500-2000', '2000-3000', '3000-4000', '4000-5000', '5000-6000', '6000-8000', '> 8000'];
            
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML += '<div class="legend-item"><div class="legend-color" style="background:' + getColor(grades[i] + 1) + '"></div>' + labels[i] + '</div>';
            }
            return div;
        };
        legend.addTo(map);
        
        function filterMap() {
            var query = document.getElementById('search').value.toLowerCase();
            
            layers.forEach(function(layer) {
                var postcode = layer.postcode.toLowerCase();
                var data = priceData[layer.postcode];
                
                if (query === '' || postcode.includes(query) || (data && data.name && data.name.toLowerCase().includes(query))) {
                    layer.setStyle({opacity: 1, fillOpacity: 0.7});
                } else {
                    layer.setStyle({opacity: 0.1, fillOpacity: 0.05});
                }
            });
        }
    </script>
</body>
</html>
